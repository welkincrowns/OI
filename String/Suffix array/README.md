后缀数组的基本应用 By strongoier

这个东西，基本是按罗穗骞的论文来学的。

这里的笔记基本只给出模型建立和转化，特定模型的做法请参考论文。

后缀数组：字符串的后缀排序。

height数组：相邻后缀的最长公共前缀。

解题关键：后缀的有序性。

一、直接应用：后缀排序

【例1】BZOJ 1031 字符加密

将原字符串复制两遍进行后缀排序，就得到了原串旋转后的各个串的大小关系，然后按顺序输出即可。

二、单个字符串

1、重复子串：二分与分组的技巧。

【例2】POJ 1743 Musical Theme

要求加减常数后相同的乐段，那么第一步要将原数组作差得到新数组，当然第一位是要特殊处理的，然后就转化为了不可重叠最长重复子串问题，不过要注意在判断的时候新数组相同段长度加1才是原数组相同段长度。

【例3】POJ 3261 Milk Patterns

至少出现k次可重叠最长重复子串问题，由于输入的初始值较大，第一步可以通过sort完成后缀数组的初始化过程。

2、子串个数

【例4】SPOJ DISUBSTR/SUBST1

后缀排序后从小到大依次处理，发现和第i个公共前缀最长的必然是第i - 1个，故有height[i]个前缀已被之前计算过，那么它的贡献值为n - sa[i] - height[i]，求和即可。

3、回文子串：倒序复制，枚举中心。

【例5】Ural 1297 Palindrome

最长回文子串问题，注意求i和j的最长公共前缀时比较i和j的大小，且实际上是RMQ(i + 1, j)。

4、连续重复子串：枚举与调整弥补。

【例6】SPOJ REPEATS

重复次数最多连续重复子串问题，枚举重复子串长度L，考虑至少重复两次的情况，枚举s[0], s[L], s[2 * L], ..., s[N / L * L]，当其中相邻两个（s[i]和s[i + L]）相等时，我们也就找到了可能连续重复的位置i。虽然我们不知道i是子串的哪一位，但是通过求LCP(i, i + L) / L可以得到重复次数的下限。同时我们可以发现除下来还有一个余数，只有当子串的起始位置向前调整L - 余数时，重复次数才会增加1，所以处理完这种情况就可以得到此时的答案。

【例7】POJ 3693 Maximum repetition substring

和上一个题基本一样，但它要求输出字典序最小的方案，此时就不能只考虑次数了，而要依次将位置的前移进行枚举，将每次得到的答案进行字典序比较。

三、两个字符串

四、多个字符串